# APIcommon
## 常見的API架構介紹

### 什麼是API:
* API是應用程式介面（Application Programming Interface）的縮寫。
* API是一種介面，它定義了軟體之間的互動，以及可以進行的呼叫或請求的種類，如何進行呼叫或發出請求，應使用的資料格式，應遵循的慣例等。
* API是串接兩端裝置或應用程式的橋樑，創造連結，實現資訊或技術的交換、溝通。
* 使用API能大幅減少開發成本，只需傳送需求，就能回傳資料，讓程式設計更便利。
* API最常使用的資料格式是JSON，也是現代各大網站最普遍的資料格式，比起XML較簡單靈活，相比之下，JSON更輕量、更方便，可讀性更高、傳遞更快速。


### MQTT:
![MQTT](https://github.com/jerry7776112/APIcommon/blob/main/API_architecture_image/1mqtt.png "link")

##### 介紹:
* MQTT API架構是依據 **發布/訂閱模式** 的訊息傳輸協定。
* MQTT API架構由三個主要元素組成：**發布者**、**代理人**和**訂閱者**。
* **發布者**是訊息的來源，**代理人**是伺服器軟體，而**訂閱者**則是訊息的接收端。
* MQTT API架構的訊息格式非常精簡，由**標頭**和**內容**兩部分組成。
* MQTT API架構的標頭採用數字編碼，整個長度只佔2位元組，等同兩個字元。
* MQTT API架構的主題名稱是UTF-8編碼的字串，支援類似檔案路徑的階層式命名方式。
* MQTT API架構的訊息內容非常適合用於**處理器資源**及**網路頻寬有限**的**物聯網裝置**。
* MQTT API架構已經有許多程式庫被陸續開發出來，用於Arduino控制板（C/C++）、JavaScript(Node.js, Espruino控制板), Python等等，還有開放原始碼的MQTT伺服器，使得開發MQTT物聯網、機器之間（Machine-to-Machine, M2M）的通訊變得非常簡單。

##### 優點:
* **輕量高效：** MQTT實作需要最少的資源，因此甚至可用於較小的微型控制器。例如，最小的 MQTT 控制訊息可以少至兩個資料位元組。MQTT 訊息標頭也很小，因此可以最佳化網路頻寬。
* **可擴展：** MQTT 實作需要最少量的程式碼，在操作中消耗的能量極少。該協定還具有各種內建功能，支援與大量 IoT 裝置進行通訊。因此，可以實作 MQTT 協定，來連線數百萬部此類裝置。
* **可靠：** MQTT 具有各種內置功能，可減少 IoT 裝置重新連線雲端所需的時間。此外，它還定義了三種不同的服務品質水準，以確保 IoT 使用案例的可靠性 – 最多一次 (0)、至少一次 (1) 和正好一次 (2)。
* **安全：** MQTT 讓開發人員能夠輕鬆地使用現代身分驗證協定 (如 OAuth、TLS1.3、客戶受管憑證等) 來加密訊息，並對裝置和使用者進行身分驗證。
出色的支援：Python 之類的多種語言對 MQTT 協定實作提供廣泛的支援。因此，開發人員可在任何類型的應用程式中，以最少的編碼快速實作。

##### 缺點:
* **資料可能會遺失：** QoS 1 佔用頻寬與傳送時間較少，但資料可能會遺失。QoS 2 佔用頻寬與傳送時間較多，但不會重覆傳送相同訊息。
* **Subscriber 可能會收到重複的訊息：** QoS 2 可能會導致 Subscriber 收到重複的訊息。

### GraphQL:
![GraphQL](https://github.com/jerry7776112/APIcommon/blob/main/API_architecture_image/2graphQL.png "link")

##### 介紹:
* GraphQL API架構是一種API查詢語言，用於定義用戶端應用程式如何從遠端伺服器請求資料的規範。
* GraphQL API架構的設計目的是為了提高API效能和靈活性。
* GraphQL API架構的查詢只能在一個API請求和回應交換中傳回確切的資料。
* GraphQL API架構的查詢由欄位和物件組成，並且可以嵌套。
* GraphQL API架構的查詢可以包含變數，這些變數可以在查詢中使用。
* GraphQL API架構的查詢可以包含指令，這些指令可以修改查詢的執行方式。
* GraphQL API架構的查詢可以包含片段，這些片段可以重複使用。
* GraphQL API架構的查詢可以包含枚舉，這些枚舉可以用於限制查詢的輸出。
* GraphQL API架構的查詢可以包含介面和聯合，這些介面和聯合可以用於定義複雜的資料模型。
* GraphQL API架構的查詢可以包含自訂標量，這些自訂標量可以用於定義特定的資料類型。

##### 優點:
* **精確的資料取得：** GraphQL 允許您精確地指定需要從 API 中擷取的資料，從而減少了不必要的資料傳輸。這使得 API 更加高效，並且可以更快地回應用戶端的請求。
* **可擴展：** GraphQL 具有可擴展性，因此可以輕鬆地添加新的功能和資料類型。它還支援多種程式語言，包括 JavaScript、Python、Ruby、Java 和 C# 等，因此可以輕鬆地在不同的平台上使用。
* **前端控制權提升：** GraphQL 允許前端開發人員控制資料的結構和格式，從而使得前端開發人員更加靈活地設計和開發應用程式。
* **程式即文檔：** GraphQL 的 Schema 定義了 API 的資料模型，因此可以輕鬆地生成 API 的文檔。這使得開發人員可以更快地理解 API 的資料模型和結構。
* **強型別：** GraphQL 具有強型別，因此可以在編譯時檢查錯誤，從而減少了運行時錯誤的可能性。

##### 缺點:
* **複雜性：** GraphQL 的學習曲線比較陡峭，因此需要更多的時間和精力來學習和使用。此外，GraphQL 的 Schema 定義比較複雜，因此需要更多的時間和精力來設計和維護。
* **性能：** GraphQL 的查詢語句可能包含大量的嵌套字段和復雜的查詢，這可能會導致查詢執行時間較長，從而影響 API 的響應時間。此外，GraphQL 的查詢語句可能會導致資料庫的負載增加，從而影響整個應用程式的性能。
* **安全性：** GraphQL 的 Schema 定義了 API 的資料模型，因此需要特別注意安全性問題。例如，如果 Schema 定義不當，可能會導致資料泄露或其他安全問題。
* **無法緩存：** 由於 GraphQL 的查詢語句是動態生成的，因此很難對其進行緩存。這可能會導致 API 的性能問題。

### REST:
![REST](https://github.com/jerry7776112/APIcommon/blob/main/API_architecture_image/3rest.png "link")

##### 介紹:
* REST API架構是一種基於HTTP協議的軟體架構，用於定義網路應用程式如何進行通訊。
* REST API架構的核心概念是資源，每個資源都有一個唯一的識別符號，並且可以透過HTTP方法（GET、POST、PUT、DELETE等）進行操作。
* REST API架構的設計目的是為了提高API效能和靈活性。
* REST API架構的訊息格式非常精簡，由**標頭**和**內容**兩部分組成。
* REST API架構的標頭包含了HTTP方法、資源識別符號、網路媒體類型等資訊。
* REST API架構的內容可以是XML、JSON等格式，並且可以透過HTTP壓縮技術進行傳輸。
* REST API架構的設計可以**支援多種客戶端**，包括**網頁瀏覽器、手機應用程式等**。
* REST API架構的設計可以支援多種伺服器端技術，包括Java、Python、Ruby等。
##### 優點:
* **簡單：** RESTful API 的設計簡單，容易理解和使用。
* **可擴展：** RESTful API 具有可擴展性，因此可以輕鬆地添加新的功能和資料類型。它還支援多種程式語言，包括 JavaScript、Python、Ruby、Java 和 C# 等，因此可以輕鬆地在不同的平台上使用。
* **可緩存：** RESTful API 可以使用 HTTP 協定的快取機制，從而提高 API 的效能和回應速度。
* **無狀態：** RESTful API 是無狀態的，因此可以更輕鬆地實現負載平衡和容錯處理。
* **易於測試：** RESTful API 的設計使其易於測試和調試。

##### 缺點:
* **資料傳輸量大：** RESTful API 的資料傳輸量比較大，因此可能會影響 API 的效能和回應速度。
* **安全性：** RESTful API 的安全性問題需要特別注意。例如，如果 API 的設計不當，可能會導致資料泄露或其他安全問題。
* **無法處理複雜查詢：** RESTful API 的查詢語句比較簡單，因此無法處理複雜的查詢需求。如果需要處理複雜的查詢需求，可能需要使用其他類型的 API。
* **無法處理事務：** RESTful API 無法處理事務，因此如果需要處理事務，可能需要使用其他類型的 API。

### SOAP:
![SOAP](https://github.com/jerry7776112/APIcommon/blob/main/API_architecture_image/4soap.png "link")

##### 介紹:
* SOAP API架構是一種基於XML的協定，用於定義網路應用程式如何進行通訊。
* SOAP API架構的核心概念是訊息，每個訊息都有一個唯一的識別符號，並且可以透過HTTP方法（GET、POST、PUT、DELETE等）進行操作。
* SOAP API架構的設計目的是為了提高API效能和靈活性。
* SOAP API架構的訊息格式非常精簡，由**標頭**和**內容**兩部分組成。
* SOAP API架構的標頭包含了訊息的元數據，例如訊息的大小、類型、目的地等資訊。
* SOAP API架構的內容可以是XML、JSON等格式，並且可以透過HTTP壓縮技術進行傳輸。
* SOAP API架構的設計可以支援多種客戶端，包括網頁瀏覽器、手機應用程式等。
* SOAP API架構的設計可以支援多種伺服器端技術，包括Java、Python、Ruby等。


##### 優點:
* **安全性高：** SOAP 具有內建的安全性功能，例如 WS-Security，可確保資料在傳輸過程中不會被竊聽或竄改。
* **可靠性高：** SOAP 具有內建的錯誤處理功能，可確保資料在傳輸過程中不會遺失或重複傳送。
* **資料傳輸量小：** SOAP 使用 XML 格式，因此資料傳輸量比較小，可提高 API 的效能和回應速度。
* **可擴展性高：** SOAP 具有可擴展性，因此可以輕鬆地添加新的功能和資料類型。它還支援多種程式語言，包括 Java、C#、Python 和 Ruby 等，因此可以輕鬆地在不同的平台上使用。

##### 缺點:
* **複雜性高：** SOAP 的設計比較複雜，因此需要更多的時間和精力來學習和使用。此外，SOAP 的資料格式比較複雜，因此需要更多的時間和精力來設計和維護。
* **效能低：** SOAP 的資料傳輸量比較小，但由於使用 XML 格式，因此效能比較低，可能會影響 API 的效能和回應速度。
* **無法緩存：** 由於 SOAP 的資料格式比較複雜，因此很難對其進行緩存。這可能會導致 API 的效能問題。
* **無法處理複雜查詢：** SOAP 的查詢語句比較簡單，因此無法處理複雜的查詢需求。如果需要處理複雜的查詢需求，可能需要使用其他類型的 API。


### Webhook:
![Webhook](https://github.com/jerry7776112/APIcommon/blob/main/API_architecture_image/5webhook.png "link")

##### 介紹:
* Webhook API是一種事件驅動的API，它可以在特定的觸發條件下發送訊息或執行特定的功能。
* Webhook API不需要雙向通訊，而是只需要單向的數據流動。
* Webhook API可以在特定的觸發條件下發送訊息或執行特定的功能，例如時間、點擊按鈕或接收表單提交等。
* Webhook API通常被稱為“反向API”，因為它是由發送數據的應用程序啟動傳輸的。
* Webhook API相對於完整的API系統而言，使用的訊息較少，因此其用途比較有限。
* Webhook API需要開發人員指定API端點，以便其他應用程序可以訪問。

##### 優點:
* Webhook API可以在特定的觸發條件下發送信息或執行特定的功能，例如時間、點擊按鈕或接收表單提交等。
* Webhook API不需要雙向通訊，而是只需要單向的數據流動，因此可以減少通訊的開銷。
* Webhook API相對於完整的API系統而言，使用的訊息較少，因此其用途比較有限。
* Webhook API可以在特定的觸發條件下發送信息或執行特定的功能，例如時間、點擊按鈕或接收表單提交等。

##### 缺點:
* Webhook API需要開發人員指定API端點，以便其他應用程序可以訪問它，因此需要額外的配置。


### Websocket:
![Websocket](https://github.com/jerry7776112/APIcommon/blob/main/API_architecture_image/6websocket.png "link")

##### 介紹:
* WebSocket API 是一種先進的技術，它使得在使用者的瀏覽器和服務器之間建立雙向互動通信會話成為可能。使用 WebSocket API，您可以向服務器發送消息並接收事件驅動的響應，而無需輪詢服務器以獲取回復。
* 以下為 WebSocket API 的主要介面：
    * WebSocket：用於連接到 WebSocket 服務器並在連接上傳送和接收數據的主要介面。
    * CloseEvent：當連接關閉時 WebSocket 對象發送的事件。
    * MessageEvent：當從服務器接收到消息時 WebSocket 對象發送的事件。
 

##### 優點:
* WebSocket 協議使用持久連接，而不是像 HTTP 長輪詢等基於 HTTP 的實時機制。WebSockets 需要的寬頻更少，延遲更低，從而減少了客戶端和服務器的負載。
* WebSocket 技術成熟，受到廣泛的採用。幾乎所有的 Web 瀏覽器都原生支援 WebSocket API，並且有許多庫和框架實現了 WebSocket 協議。
* WebSocket 技術靈活，允許實現應用級別協議和擴展，以實現額外的功能（例如發布/訂閱消息）。
* WebSocket 是事件驅動的技術，數據一旦可用就會被推送，而不需要輪詢。這種特性在客戶端需要快速響應事件的情況下非常有用（特別是那些無法預測的事件，例如欺詐警報）。
* WebSocket 提供了一個全雙工、雙向通信通道。這意味著服務器可以向客戶端發送消息，而兩者可以同時發送低延遲的消息。因此，WebSocket 適用於雙向、多用戶的實時 Web 應用程序，例如聊天室。

##### 缺點:
* WebSocket 協議不適用於流式音樂和影片數據。在這種情況下，WebRTC 等技術更適合。
* WebSocket 不會在連接終止時自動恢復，這是您需要自己實現的功能之一，也是存在許多 WebSocket 客戶端庫的原因之一。
* 某些環境（例如具有代理服務器的企業網絡）將阻止 WebSocket 連接。很可能需要考慮支援這些情況的回退傳輸，而這將會增加額外的工程複雜性和成本。

### gRPC:
![gRPC](https://github.com/jerry7776112/APIcommon/blob/main/API_architecture_image/7gRPC.png "link")

##### 介紹:
* gRPC API架構是一種基於HTTP/2協議的遠端程序呼叫（RPC）框架。
* gRPC API架構使用Protocol Buffers作為介面描述語言，支援多種程式語言，例如Java、Python、C++等等。
* gRPC API架構的核心概念是服務和方法，服務定義了一組相關的方法，而方法則定義了輸入和輸出的訊息類型。
* gRPC API架構支援四種方法類型：單向流、伺服器串流、客戶端串流和雙向串流。
* gRPC API架構的設計目的是為了提高API效能和靈活性。
* gRPC API架構的訊息格式非常精簡，由標頭和內容兩部分組成。
* gRPC API架構的標頭包含了HTTP方法、資源識別符號、網路媒體類型等資訊。
* gRPC API架構的內容可以是二進位格式，並且可以透過HTTP/2壓縮技術進行傳輸。
* gRPC API架構的設計可以支援多種客戶端，包括網頁瀏覽器、手機應用程式等。
* gRPC API架構的設計可以支援多種伺服器端技術，包括Java、Python、C++等。

##### 優點:
* **高效性：** gRPC 使用 Protocol Buffers 作為預設的序列化機制，可大幅減少傳輸數據的大小，並提高傳輸效率。
* **跨語言支援：** gRPC 支持多種編程語言，包括 C++、Java、Python、Go、Ruby、C# 等。
* **多種平台支援：** gRPC 支持多種平台，包括 Linux、Windows、macOS 等。
* **多種傳輸協議支援：** gRPC 支持多種傳輸協議，包括 HTTP/2、gRPC 自有協議等。

##### 缺點:
* **學習曲線較陡峭：** gRPC 的使用需要一定的學習成本，尤其是對於初學者來說。
* **不支援瀏覽器：** 由於 gRPC 使用 HTTP/2 協議，而瀏覽器對於 HTTP/2 的支持度較低，因此 gRPC 目前還不支持瀏覽器。
